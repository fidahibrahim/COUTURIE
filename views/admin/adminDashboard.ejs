<%-include('../layout/admin/header.ejs') %>
    <div class="preloader">
        <div class="lds-ripple">
            <div class="lds-pos"></div>
            <div class="lds-pos"></div>
        </div>
    </div>
    <div id="main-wrapper" data-theme="light" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
        data-sidebar-position="fixed" data-header-position="fixed" data-boxed-layout="full">
        <%-include('../layout/admin/navbar.ejs') %>
            <%-include('../layout/admin/nav.ejs') %>
                <div class="page-wrapper">
                    <div class="container-fluid">
                        <a
                            style="color: rgb(73, 70, 70); font-family:Cambria, Cochin, Georgia, Times, 'Times New Roman', serif ;">
                            <h1>Dashboard </h1>
                        </a>
                        <p>Whole data about your business is here.</p>

                        <!-- sales report -->
                        <a href="/admin/salesDaily">
                            <button class=" btn btn-outline-secondary"
                                style="margin-bottom: 1%; margin-left: 88%;">Sales Report</button>
                        </a>

                        <div class="card-group">
                            <div class="card border-right">
                                <div class="card-body">
                                    <div class="d-flex d-lg-flex d-md-block align-items-center">
                                        <div>
                                            <div class="d-inline-flex align-items-center">
                                                <h2 class="text-dark mb-1 font-weight-medium">
                                                    <%= totalUsers%>
                                                </h2>

                                            </div>
                                            <h6 class="text-muted font-weight-normal mb-0 w-100 text-truncate">Total
                                                Clients</h6>
                                        </div>
                                        <div class="ml-auto mt-md-3 mt-lg-0">
                                            <span class="opacity-7 text-muted"><i data-feather="user-plus"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card border-right">
                                <div class="card-body">
                                    <div class="d-flex d-lg-flex d-md-block align-items-center">
                                        <div>
                                            <h2 class="text-dark mb-1 w-100 text-truncate font-weight-medium"><sup
                                                    class="set-doller">₹</sup>
                                                <%= totalRevenue %>
                                            </h2>
                                            <h6 class="text-muted font-weight-normal mb-0 w-100 text-truncate">Total
                                                Revenue
                                            </h6>
                                        </div>
                                        <div class="ml-auto mt-md-3 mt-lg-0">
                                            <span class="opacity-7 text-muted"><i data-feather="dollar-sign"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card border-right">
                                <div class="card-body">
                                    <div class="d-flex d-lg-flex d-md-block align-items-center">
                                        <div>
                                            <div class="d-inline-flex align-items-center">
                                                <h2 class="text-dark mb-1 font-weight-medium">
                                                    <%= totalOrders%>
                                                </h2>

                                            </div>
                                            <h6 class="text-muted font-weight-normal mb-0 w-100 text-truncate">Total
                                                Orders</h6>
                                        </div>
                                        <div class="ml-auto mt-md-3 mt-lg-0">
                                            <span class="opacity-7 text-muted"><i data-feather="file-plus"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex d-lg-flex d-md-block align-items-center">
                                        <div>
                                            <h2 class="text-dark mb-1 font-weight-medium">
                                                <%= totalProducts%>
                                            </h2>
                                            <h6 class="text-muted font-weight-normal mb-0 w-100 text-truncate">Products
                                            </h6>
                                        </div>
                                        <div class="ml-auto mt-md-3 mt-lg-0">
                                            <span class="opacity-7 text-muted"><i data-feather="globe"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6 col-md-12">

                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="card-title">Payment Options</h4>
                                        <div id="morris-donut-chart" style="height: 250px;"></div>
                                    </div>
                                </div>

                            </div>
                            <div class="col-lg-6 col-md-9">
                                <div class="card" style="height: 93%;">
                                    <div class="card-body">
                                        <h4 class="card-title">Monthly</h4>
                                        <div>
                                            <canvas id="line-chart" height="210"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6 col-md-4">
                                <div class="card" style="margin-top: -24%;">
                                    <div class="card-body">
                                        <h4 class="card-title">Spotlight</h4>
                                        <div class="mt-4 activity">
                                            <div class="d-flex align-items-start border-left-line pb-3">
                                                <div>
                                                    <a href="javascript:void(0)"
                                                        class="btn btn-info btn-circle mb-2 btn-item">
                                                        <i data-feather="shopping-cart"></i>
                                                    </a>
                                                </div>
                                                <div class="ml-3 mt-2">
                                                    <h5 class="text-dark font-weight-medium mb-2">Best Selling Products
                                                    </h5>
                                                    <% if(bestProducts.length < 1){ %>
                                                        <h1>No Orders</h1>
                                                        <% }else{ %>
                                                            <% bestProducts.forEach((product)=>{ %>
                                                                <div class="dis" style="display: flex;">
                                                                    <div class="image" style="width:28%;">
                                                                        <img src="/assets/images/productImg/sharpedImg/<%= product.productImg[0] %>"
                                                                            alt="Product Image"
                                                                            style="width: 85%; height: 83%;">
                                                                    </div>
                                                                    <div class="text">
                                                                        <p style="margin-top: 9px;margin-bottom: 3%;">
                                                                            Product Name: <%= product.productName %>
                                                                        </p>
                                                                        <p>Product Id: <%= product._id %>
                                                                        </p>
                                                                        <p style="margin-top: -6%;">Quantity: <%=
                                                                                product.quantitySold %>
                                                                        </p>
                                                                    </div>
                                                                </div>
                                                                <% }) %>
                                                                    <%}%>
                                                </div>
                                            </div>
                                            <div class="d-flex align-items-start border-left-line pb-3">
                                                <div>
                                                    <a href="javascript:void(0)"
                                                        class="btn btn-danger btn-circle mb-2 btn-item">
                                                        <i data-feather="message-square"></i>
                                                    </a>
                                                </div>
                                                <div class="ml-3 mt-2">
                                                    <h5 class="text-dark font-weight-medium mb-2">Best Selling Category
                                                    </h5>
                                                    <% bestCategories.forEach((category)=>{ %>
                                                        <p>
                                                            <%= category.categoryName %>
                                                        </p>
                                                        <% }) %>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-6     col-md-9">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="card-title">Yearly</h4>
                                        <div>
                                            <canvas id="line-chart1" height="225"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center mb-4">
                                            <h4 class="card-title">New Users</h4>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table no-wrap v-middle mb-0">
                                                <thead>
                                                    <tr class="border-0">
                                                        <th class="border-0 font-14 font-weight-medium text-muted">si.no
                                                        </th>
                                                        <th class="border-0 font-14 font-weight-medium text-muted px-2">
                                                            User Name
                                                        </th>
                                                        <th class="border-0 font-14 font-weight-medium text-muted">
                                                            E-mail</th>
                                                        <th
                                                            class="border-0 font-14 font-weight-medium text-muted text-center">
                                                            Mobile
                                                        </th>
                                                        <th
                                                            class="border-0 font-14 font-weight-medium text-muted text-center">
                                                            Joined Date
                                                        </th>
                                                    </tr>

                                                </thead>
                                                <tbody>
                                                    <% latestUsers.forEach((user,index)=>{ %>
                                                        <tr>
                                                            <td class="border-top-0 px-2 py-4">
                                                                <%= index+1 %>
                                                            </td>
                                                            <td class="border-top-0 text-muted px-2 py-4 font-14">
                                                                <%= user.username %>
                                                            </td>
                                                            <td class="border-top-0 px-2 py-4">
                                                                <%= user.email %>
                                                            </td>
                                                            <td class="border-top-0 text-center px-2 py-4">
                                                                <%= user.mobile %>

                                                            </td>
                                                            <td
                                                                class="border-top-0 text-center font-weight-medium text-muted px-2 py-4">
                                                                <%= user.createdAt.toLocaleDateString() %>
                                                            </td>
                                                        </tr>
                                                        <% }) %>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center mb-4">
                                            <h4 class="card-title">New orders</h4>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table no-wrap v-middle mb-0">
                                                <thead>
                                                    <tr class="border-0">
                                                        <th class="border-0 font-14 font-weight-medium text-muted">si.no
                                                        </th>
                                                        <th class="border-0 font-14 font-weight-medium text-muted px-2">
                                                            Order Id
                                                        </th>
                                                        <th class="border-0 font-14 font-weight-medium text-muted">Date
                                                        </th>
                                                        <th
                                                            class="border-0 font-14 font-weight-medium text-muted text-center">
                                                            Total
                                                        </th>
                                                        <th
                                                            class="border-0 font-14 font-weight-medium text-muted text-center">
                                                            Payment Status
                                                        </th>
                                                        <th
                                                            class="border-0 font-14 font-weight-medium text-muted text-center">
                                                            Payment Method
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <% latestOrders.forEach((order,index)=>{ %>
                                                        <tr>
                                                            <td class="border-top-0 px-2 py-4">
                                                                <%= index+1 %>
                                                            </td>
                                                            <td class="border-top-0 text-muted px-2 py-4 font-14">
                                                                <%= order.orderId%>
                                                            </td>
                                                            <td class="border-top-0 px-2 py-4">
                                                                <%= moment(order.date).format('DD/MM/YYYY') %>
                                                            </td>
                                                            <td class="border-top-0 text-center px-2 py-4">₹<%=
                                                                    order.totalAmount %>
                                                            </td>
                                                            <td
                                                                class="border-top-0 text-center font-weight-medium text-muted px-2 py-4">
                                                                <%= order.products.status %>
                                                            </td>
                                                            <td
                                                                class="border-top-0 text-center font-weight-medium text-muted px-2 py-4">
                                                                <%= order.paymentMethod %>
                                                            </td>

                                                        </tr>
                                                        <% }) %>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    </div>


    <!-- ==============monthly and yearly sales===================== -->

    <input type="hidden" value="<%= updatedYearlyValues[0].total %>" id="2019">
    <input type="hidden" value="<%= updatedYearlyValues[1].total %>" id="2020">
    <input type="hidden" value="<%= updatedYearlyValues[2].total %>" id="2021">
    <input type="hidden" value="<%= updatedYearlyValues[3].total %>" id="2022">
    <input type="hidden" value="<%= updatedYearlyValues[4].total %>" id="2023">
    <input type="hidden" value="<%= updatedYearlyValues[5].total %>" id="2024">



    <input type="hidden" value="<%= updatedMonthlyValues[0].total %>" id="Jan">
    <input type="hidden" value="<%= updatedMonthlyValues[1].total %>" id="Feb">
    <input type="hidden" value="<%= updatedMonthlyValues[2].total %>" id="March">
    <input type="hidden" value="<%= updatedMonthlyValues[3].total %>" id="April">
    <input type="hidden" value="<%= updatedMonthlyValues[4].total %>" id="May">
    <input type="hidden" value="<%= updatedMonthlyValues[5].total %>" id="June">
    <input type="hidden" value="<%= updatedMonthlyValues[6].total %>" id="July">
    <input type="hidden" value="<%= updatedMonthlyValues[7].total %>" id="Aug">
    <input type="hidden" value="<%= updatedMonthlyValues[8].total %>" id="Sep">
    <input type="hidden" value="<%= updatedMonthlyValues[9].total %>" id="Oct">
    <input type="hidden" value="<%= updatedMonthlyValues[10].total %>" id="Nov">
    <input type="hidden" value="<%= updatedMonthlyValues[11].total %>" id="Dec">


    <!-- ================monthly and yearly orders==================== -->

    <input type="hidden" value="<%= updatedYearlyOrders[0].totalOrder %>" id="order2019">
    <input type="hidden" value="<%= updatedYearlyOrders[1].totalOrder %>" id="order2020">
    <input type="hidden" value="<%= updatedYearlyOrders[2].totalOrder %>" id="order2021">
    <input type="hidden" value="<%= updatedYearlyOrders[3].totalOrder %>" id="order2022">
    <input type="hidden" value="<%= updatedYearlyOrders[4].totalOrder %>" id="order2023">
    <input type="hidden" value="<%= updatedYearlyOrders[5].totalOrder %>" id="order2024">


    <input type="hidden" value="<%= updatedMonthlyOrders[0].totalOrders %>" id="jan">
    <input type="hidden" value="<%= updatedMonthlyOrders[1].totalOrders %>" id="feb">
    <input type="hidden" value="<%= updatedMonthlyOrders[2].totalOrders %>" id="march">
    <input type="hidden" value="<%= updatedMonthlyOrders[3].totalOrders %>" id="april">
    <input type="hidden" value="<%= updatedMonthlyOrders[4].totalOrders %>" id="may">
    <input type="hidden" value="<%= updatedMonthlyOrders[5].totalOrders %>" id="june">
    <input type="hidden" value="<%= updatedMonthlyOrders[6].totalOrders %>" id="july">
    <input type="hidden" value="<%= updatedMonthlyOrders[7].totalOrders %>" id="aug">
    <input type="hidden" value="<%= updatedMonthlyOrders[8].totalOrders %>" id="sep">
    <input type="hidden" value="<%= updatedMonthlyOrders[9].totalOrders %>" id="oct">
    <input type="hidden" value="<%= updatedMonthlyOrders[10].totalOrders %>" id="nov">
    <input type="hidden" value="<%= updatedMonthlyOrders[11].totalOrders %>" id="dec">



    <!-- ===========monthly and yearly users==================== -->

    <input type="hidden" value="<%= updatedYearlyUsers[0].totalUsers %>" id="users2019">
    <input type="hidden" value="<%= updatedYearlyUsers[1].totalUsers %>" id="users2020">
    <input type="hidden" value="<%= updatedYearlyUsers[2].totalUsers %>" id="users2021">
    <input type="hidden" value="<%= updatedYearlyUsers[3].totalUsers %>" id="users2022">
    <input type="hidden" value="<%= updatedYearlyUsers[4].totalUsers %>" id="users2023">
    <input type="hidden" value="<%= updatedYearlyUsers[5].totalUsers %>" id="users2024">



    <input type="hidden" value="<%= updatedMonthlyUsers[0].totalUsers %>" id="JAN">
    <input type="hidden" value="<%= updatedMonthlyUsers[1].totalUsers %>" id="FEB">
    <input type="hidden" value="<%= updatedMonthlyUsers[2].totalUsers %>" id="MAR">
    <input type="hidden" value="<%= updatedMonthlyUsers[3].totalUsers %>" id="APR">
    <input type="hidden" value="<%= updatedMonthlyUsers[4].totalUsers %>" id="MAY">
    <input type="hidden" value="<%= updatedMonthlyUsers[5].totalUsers %>" id="JUN">
    <input type="hidden" value="<%= updatedMonthlyUsers[6].totalUsers %>" id="JUL">
    <input type="hidden" value="<%= updatedMonthlyUsers[7].totalUsers %>" id="AUG">
    <input type="hidden" value="<%= updatedMonthlyUsers[8].totalUsers %>" id="SEP">
    <input type="hidden" value="<%= updatedMonthlyUsers[9].totalUsers %>" id="OCT">
    <input type="hidden" value="<%= updatedMonthlyUsers[10].totalUsers %>" id="NOV">
    <input type="hidden" value="<%= updatedMonthlyUsers[11].totalUsers %>" id="DEC">



    <input type="hidden" value="<%= paymentCounts.cod %>" id="cod">
    <input type="hidden" value="<%= paymentCounts.razorpay %>" id="razorpay">
    <input type="hidden" value="<%= paymentCounts.wallet %>" id="wallet">



    <%-include('../layout/admin/footer.ejs') %>